!function(e,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):(e="undefined"!=typeof globalThis?globalThis:e||self).vulture=i()}(this,(function(){"use strict";const e=[{field:"about",priority:1},{field:"aboutMe",priority:1},{field:"address",priority:1},{field:"bio",priority:1},{field:"city",priority:1},{field:"confirmPassword",priority:1},{field:"country",priority:1},{field:"coverPic",priority:0},{field:"dateOfBirth",priority:1},{field:"dob",priority:1},{field:"description",priority:1},{field:"education",priority:1},{field:"email",priority:1},{field:"firstName",priority:1},{field:"fname",priority:1},{field:"fullName",priority:1},{field:"gender",priority:1},{field:"initials",priority:0},{field:"interests",priority:0},{field:"isBlocked",priority:0},{field:"isDeleted",priority:0},{field:"isEmailVerified",priority:0},{field:"isVerified",priority:0},{field:"lastLoginAt",priority:0},{field:"lastName",priority:1},{field:"name",priority:1},{field:"location",priority:1},{field:"middleName",priority:0},{field:"mobile",priority:1},{field:"nameSurname",priority:0},{field:"nickName",priority:0},{field:"occupation",priority:1},{field:"other",priority:0},{field:"password",priority:1},{field:"phone",priority:1},{field:"postalCode",priority:1},{field:"profilePic",priority:0},{field:"profileStatus",priority:0},{field:"profileType",priority:0},{field:"profileVisibility",priority:0},{field:"resume",priority:0},{field:"sex",priority:1},{field:"skills",priority:1},{field:"state",priority:1},{field:"timezone",priority:0},{field:"title",priority:0},{field:"updatedAt",priority:0},{field:"username",priority:0},{field:"website",priority:0},{field:"workExperience",priority:1}],i=e=>Array.isArray(e)&&e.length>0,r=new Set(["com","net","org","edu","gov","mil","co","io","tech","dev","info","biz","me","us","uk","ca","au","in","eu","de","fr","xyz","site","online","store","blog","app"]),t=new Set(["10minutemail.com","temp-mail.org","guerrillamail.com","mailinator.com","yopmail.com","fakemailgenerator.com","sharklasers.com","dispostable.com","throwawaymail.com","getnada.com","trashmail.com","mintemail.com","spambog.com","maildrop.cc","spamex.com","mytrashmail.com","boun.cr","tmail.io","mailpoof.com","spamavert.com","harakirimail.com","tempmail.com","tempmail.net","emailtemporario.com.br"]),o=new Set(["gmail.com","yahoo.com","outlook.com","hotmail.com","aol.com","icloud.com","protonmail.com","yandex.com","mail.com","zoho.com","gmx.com","fastmail.com","tutanota.com","live.com","msn.com","me.com","qq.com","naver.com","rediffmail.com","rocketmail.com","inbox.com","btinternet.com","shaw.ca","telus.net","cox.net","sbcglobal.net","verizon.net","att.net","comcast.net","optonline.net","bigpond.com","bluewin.ch","earthlink.net","mac.com","web.de","126.com","163.com","yeah.net","lycos.com"]),a=["123456","password","123456789","12345678","12345","1234567","qwerty","abc123","password1","111111","123123","admin","welcome","letmein","monkey","football","iloveyou","sunshine","1234","princess","dragon","baseball","superman","trustno1","shadow","buster","qwerty123","batman","whatever","password123","qazwsx","1q2w3e4r","123qwe","123abc","654321","7777777"];function n(r=[],{strict:t=!1,augment:o}){const a=e.filter((e=>1===e.priority)).map((e=>new RegExp(e.field,"i")));i(o)&&a.push(...o.map((e=>new RegExp(e,"i"))));const n=r.filter((e=>a.some((i=>i.test(e.name)))&&!/other/i.test(e.name)));let s=r.filter((e=>![...a].some((i=>i.test(e.name)))||/other/i.test(e.name)));const l=t&&s.filter((e=>a.some((i=>i.test(e.type)))));return i(l)&&n.push(...l)&&(s=s.filter((e=>!l.includes(e)))),{priority:n,non_priority:s}}function s(e,i=!1){if("string"!=typeof e||e.length<6||e.length>320)return{valid:!1,reason:"Invalid email length"};const a=e.match(/^[a-zA-Z0-9._%+-]+@([a-zA-Z0-9-]+\.[a-zA-Z]{2,})$/);if(!a)return{valid:!1,reason:"Invalid email format"};const n=a[1].toLowerCase(),s=n.split(".").pop();return t.has(n)?{valid:!1,reason:"Temporary email addresses are not allowed"}:i&&!o.has(n)?{valid:!1,reason:"Temporary or custom email addresses are not allowed"}:r.has(s)?{valid:!0,reason:"Valid email ✅"}:{valid:!1,reason:"Invalid domain extension"}}function l(e){let i=0;return a.includes(e.toLowerCase())?{strength:"Very Weak ❌",message:"This password is too common!"}:(e.length>=8&&i++,e.length>=12&&i++,/[a-z]/.test(e)&&i++,/[A-Z]/.test(e)&&i++,/[0-9]/.test(e)&&i++,/[^a-zA-Z0-9]/.test(e)&&i++,i<=2?{strength:"Weak ❌",message:"Try adding numbers & symbols."}:3===i?{strength:"Medium ⚠️",message:"Make it longer & mix characters."}:4===i?{strength:"Strong ✅",message:"Good, but longer is better!"}:{strength:"Very Strong 💪",message:"Great password! 🔥"})}function m(e){return`${(e.name[0].toLocaleUpperCase()+e.name.slice(1)).replace(/[_-]/g," ")} is required`}function d(e,r){let t=[];for(const i of e){if(""===i.value||null===i.value||void 0===i.value){t.push({field:i.name,message:m(i)});break}if("email"===i.type){const{valid:e,reason:o}=s(i.value,r);e||t.push({field:i.name,message:o})}if(r&&"password"===i.type){const{strength:e,message:r}=l(i.value);e.includes("Weak")&&t.push({field:i.name,message:r})}}if(i(e)){const i=e.filter((e=>"password"===e.type.toLocaleLowerCase()));2===i.length&&(/password/i.test(i[0].name)&&/confirm/i.test(i[1].name)||/password/i.test(i[1].name)&&/confirm/i.test(i[0].name))&&i[0].value!==i[1].value&&t.push({field:i[1].name,message:"Passwords do not match"})}return{fields:e,errors:t}}const c=["submit","reset"];function f(e){const r=[],t=[];if(Array.from(e.children).forEach((e=>{"INPUT"!==e.tagName&&"TEXTAREA"!==e.tagName||!(e.name||e.type||e.value)||c.includes(e.type)||r.push({name:e.name,type:e.type,value:e.value}),1===e.nodeType&&e.classList.contains("error")&&t.push({id:e.id,class:"error"})})),i(r))return{scannedFields:r,errorBoxes:t};throw new Error("No fields found in the form || Please make a valid form.")}function p(e,r=[]){i(r)&&console.error("Invalid data returned by talon.");for(const t of e){const e=document.getElementById(t.id);!t.class&&e.classList.add("error");const o=i(r)&&r.find((i=>i.field===e.id));e.innerHTML=o?o.message:""}}let u,y=[],g=!1;return{connect:e=>{u=document.getElementById(e)||document.querySelector(`.${e}`);let i=Array.from(u.children).filter((e=>("INPUT"===e.tagName||"TEXTAREA"===e.tagName)&&!["submit","reset"].includes(e.type))).length;u?console.log(`Vulture protection to ${u.id||u.className}(${i}) \nVisit https://vulturejs.github.io`):console.error(`Form ID error: MultiConnect reduired Form ID,\nForm index: ${y.length+1} has no ID or Form IDs are more than forms.`)},multiConnect:e=>{let r=!1;for(const i of e){const t=document.getElementById(i);if(t?y.push(t):(console.error(`Form ID error: MultiConnect reduired Form ID,\nForm index: ${y.length+1} has no ID or Form IDs are more than forms.`),r=!0),r=!1,y.length===e.length)break}g=!0,i(e)&&!r&&console.log(`Vulture protection to ${y.map((e=>`${e.id}(${Array.from(e.children).filter((e=>("INPUT"===e.tagName||"TEXTAREA"===e.tagName)&&!["submit","reset"].includes(e.type))).length})`)).join(", ")}\nVisit https://vulturejs.github.io`)},talon:({strict:e,augment:r,render_error:t=!0})=>{e||(e=!1),r||(r=null);const{scannedFields:o,errorBoxes:a}=f(u),{priority:s,non_priority:l}=n(o,{strict:e,augment:r}),{fields:m,errors:c}=d(s,e);if(t&&p(a,c),i(c)||!i(m))return{errors:c};return{fields:[...new Set([...m,...l])]}},talonAll:(e,{strict:r,augment:t,render_error:o=!0})=>{r||(r=!1),t||(t=null),g&&(u=y[e]);const{scannedFields:a,errorBoxes:s}=f(u),{priority:l,non_priority:m}=n(a,{strict:r,augment:t}),{fields:c,errors:h}=d(l,r);if(o&&p(s,h),i(h)||!i(c))return{errors:h};return{formId:u.id,fields:[...new Set([...c,...m])]}},formatter:e=>{let i={};return e.forEach((e=>{i[e.name]=e.value})),i}}}));
